<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <style>
    /* Giới hạn tên sách hiển thị 2 dòng */
    .card-title-multi {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      max-height: 3.6em;
    }

    /* Hiệu ứng hover cho card */
    .card {
      transition: all 0.3s ease;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
    }
  </style>
</head>
<body>
  <div th:fragment="bookCard(sach)">
    <div class="card h-100 position-relative shadow-sm border-0 rounded-3">

      <!-- Badge giảm giá -->
      <div th:if="${sach.badgeDiscount != null}"
           class="position-absolute top-0 start-0 m-2 z-10">
        <span class="badge bg-danger fs-6 fw-bold">
          SALE <span th:text="${sach.badgeDiscount}">20%</span>
        </span>
      </div>

      <img class="card-img-top"
           th:src="@{${sach.anh}}"
           alt="Book cover"
           style="height: 300px; object-fit: cover;">

      <!-- Thông tin -->
      <div class="card-body p-3 text-center d-flex flex-column justify-content-between">
        <h5 class="fw-bolder card-title-multi mb-2"
            style="line-height: 1.2;"
            th:title="${sach.tenSP}"
            th:text="${sach.tenSP}">
          Tên Sách
        </h5>

        <p class="text-muted mb-2" th:text="${sach.tacGia}">Tác giả</p>

        <div class="text-muted small mb-1 d-flex align-items-center justify-content-center">
          <div class="me-2 d-flex">
            <i th:each="star : ${#numbers.sequence(1, 5)}"
               th:class="${star <= sach.averageRating} ? 'fas fa-star text-warning me-1' : 'far fa-star text-muted me-1'"
               style="font-size: 0.8rem;"></i>
          </div>
          <span th:if="${sach.totalReviews > 0}"
                th:text="(${sach.totalReviews} + ' lượt')"
                style="font-size: 0.75rem;"></span>
          <span th:unless="${sach.totalReviews > 0}" class="text-muted"
                style="font-size: 0.75rem;">Chưa đánh giá</span>
        </div>

        <div th:if="${sach.badgeDiscount != null}">
          <del class="text-muted me-2 small"
               th:text="${#numbers.formatDecimal(sach.giaBan, 0, 'COMMA', 0, 'POINT')} + ' VNĐ'">
            Giá gốc
          </del>
          <span class="fw-bold text-success fs-5"
                th:text="${#numbers.formatDecimal(sach.giaGiam, 0, 'COMMA', 0, 'POINT')} + ' VNĐ'">
            Giá giảm
          </span>
        </div>
        <div th:unless="${sach.badgeDiscount != null}">
          <span class="fw-bold fs-5"
                th:text="${#numbers.formatDecimal(sach.giaBan, 0, 'COMMA', 0, 'POINT')} + ' VNĐ'">
            Giá bán
          </span>
        </div>
      </div>

      <!-- Link chi tiết -->
      <a th:href="@{'/product-detail/' + ${sach.id}}" class="stretched-link"></a>
    </div>
  </div>
</body>
</html>
