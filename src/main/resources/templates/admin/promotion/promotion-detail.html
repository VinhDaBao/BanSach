<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{admin/layout/base}">
<head>
<meta charset="UTF-8">
<title>Chi ti·∫øt khuy·∫øn m√£i</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet">
</head>
<div layout:fragment="content">

	<div class="container-fluid pt-3 px-0">
		<a th:href="@{/admin/promotion/promotion-list}"
			class="btn btn-secondary mb-3">‚¨Ö Quay l·∫°i danh s√°ch</a>

		<div class="card shadow-lg border-0 mb-4">
			<div class="card-header bg-primary text-white">
				<h4 class="mb-0">Chi ti·∫øt khuy·∫øn m√£i</h4>
			</div>
			<div class="card-body">
				<p>
					<strong>T√™n khuy·∫øn m√£i:</strong> <span th:text="${promotion.tenKM}">T√™n
						KM</span>
				</p>
				<p>
					<strong>Th·ªùi gian:</strong> <span th:text="${promotion.ngayBD}">ngayBD</span>
					&nbsp;‚Üí&nbsp; <span th:text="${promotion.ngayKT}">ngayKT</span>
				</p>
				<p
					th:with="displayValue=${promotion.giaTri <= 1 ? (promotion.giaTri * 100) + '%': promotion.giaTri}">
					<strong>Gi√° tr·ªã:</strong> <span th:text="${displayValue}">giaTri</span>
				</p>
			</div>
		</div>

		<div class="card shadow-lg border-0 mb-4">
			<div class="card-header bg-success text-white">
				<h5 class="mb-0">üìö S√°ch ƒëang √°p d·ª•ng</h5>
			</div>
			<div class="card-body">

				<div th:if="${#lists.isEmpty(dsSachKM)}" class="alert alert-info">
					Ch∆∞a c√≥ s√°ch n√†o ƒë∆∞·ª£c √°p d·ª•ng khuy·∫øn m√£i n√†y.</div>

				<div th:if="${!#lists.isEmpty(dsSachKM)}">
					<table class="table table-striped align-middle">
						<thead>
							<tr>
								<th>M√£ s√°ch</th>
								<th>T√™n s√°ch</th>
								<th>T√°c gi·∫£</th>
								<th>Gi√° b√°n</th>
								<th>Gi√° sau gi·∫£m</th>
								<th>Thao t√°c</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="item : ${dsSachKM}">
								<td th:text="${item.sach.id}">MaSach</td>
								<td th:text="${item.sach.tenSP}">TenSP</td>
								<td th:text="${item.sach.tacGia}">TacGia</td>
								<td
									th:text="${T(java.lang.Math).round(item.sach.giaBan.doubleValue())}">GiaBan</td>
								<td
									th:text="${priceAfter[item.sach.id] != null ? T(java.lang.Math).round(priceAfter[item.sach.id]) : '-'}">GiaSauGiam</td>
								<td>
									<form
										th:action="@{/admin/promotion/{maKM}/remove	Book(maKM=${promotion.maKM})}"
										method="post" style="display: inline;">
										<input type="hidden" name="maSach" th:value="${item.sach.id}" />
										<button type="submit" class="btn btn-danger btn-sm"
											onclick="return confirm('X√°c nh·∫≠n x√≥a s√°ch kh·ªèi khuy·∫øn m√£i?');">
											X√≥a</button>
									</form>
								</td>
							</tr>
						</tbody>
					</table>
				</div>

				<hr />

				<h6 class="mt-3">‚ûï Th√™m s√°ch v√†o khuy·∫øn m√£i</h6>
				<form
					th:action="@{/admin/promotion/{maKM}/addBook(maKM=${promotion.maKM})}"
					method="post" class="d-flex gap-2 align-items-start">
					<select name="maSach" class="form-select w-auto" required>
						<option value="">-- Ch·ªçn s√°ch --</option>
						<option th:each="s : ${sachList}" th:value="${s.id}"
							th:text="${s.tenSP}">S√°ch</option>
					</select>
					<button class="btn btn-primary">Th√™m</button>
				</form>

			</div>
		</div>
	</div>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</div>
</html>