<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chi Tiết Đơn Hàng - Bookstore Admin</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
	rel="stylesheet">
<style>
body {
	background-color: #f8f9fa;
}

.sidebar {
	background-color: #ffffff;
	border-right: 1px solid #dee2e6;
}
</style>
</head>
<body>

	<nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
		<div class="container-fluid">
			<a class="navbar-brand" href="/admin/dashboard"><i
				class="bi bi-book-fill me-2"></i> Bookstore Admin</a>
			<button class="navbar-toggler" type="button"
				data-bs-toggle="collapse" data-bs-target="#navbarNav"
				aria-controls="navbarNav" aria-expanded="false"
				aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNav">
				<ul class="navbar-nav me-auto"></ul>
				<ul class="navbar-nav ms-auto">
					<li class="nav-item"><a class="nav-link"
						href="/admin/dashboard"><i class="bi bi-person-circle me-1"></i>
							Admin</a></li>
					<li class="nav-item"><a class="nav-link" href="/logout">Đăng
							Xuất</a></li>
				</ul>
			</div>
		</div>
	</nav>


	<div class="container-fluid mt-4">
		<div class="row">
			<!-- Sidebar -->
			<nav class="col-md-4 col-lg-3 bg-white sidebar p-3">
				<ul class="nav flex-column">
					<li class="nav-item"><a class="nav-link"
						href="/admin/dashboard"><i class="bi bi-speedometer2 me-2"></i>
							Dashboard</a></li>
					<li class="nav-item"><a class="nav-link" href="/admin/sach"><i
							class="bi bi-bookshelf me-2"></i> Quản Lý Sách</a></li>
					<li class="nav-item"><a class="nav-link" href="/admin/ncc"><i
							class="bi bi-bookshelf me-2"></i> Quản Lý Nhà Cung Cấp</a></li>
					<li class="nav-item"><a class="nav-link active"
						href="/admin/orders"><i class="bi bi-cart-check me-2"></i>
							Quản Lý Đơn Hàng</a></li>
					<li class="nav-item"><a class="nav-link" href="/admin/users"><i
							class="bi bi-people me-2"></i> Quản Lý Khách Hàng</a></li>
					<li class="nav-item"><a class="nav-link"
						href="/admin/promotion/promotion-list"><i
							class="bi bi-tags me-2"></i> Quản Lý Khuyến Mãi</a></li>
					<li class="nav-item"><a class="nav-link" href="/admin/tonkho"><i
							class="bi bi-box-seam me-2"></i> Quản Lý Tồn Kho</a></li>
					<li class="nav-item"><a class="nav-link active"
						href="/admin/danhgia"><i class="bi bi-chat-dots me-2"></i>
							Quản Lý Đánh Giá</a></li>
					<li class="nav-item"><a class="nav-link" href="/admin/thongke"><i
							class="bi bi-bar-chart-line me-2"></i> Thống Kê</a></li>
				</ul>
			</nav>

			<main class="col-md-8 ms-sm-auto col-lg-9 px-md-4">
				<div
					class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
					<h1 class="h2">
						<i class="bi bi-cart-check me-2"></i> Chi Tiết Đơn Hàng
					</h1>
					<div class="btn-toolbar mb-2 mb-md-0">
						<a th:href="@{/admin/orders}" class="btn btn-secondary">Quay
							Lại Danh Sách</a>
					</div>
				</div>

				<!-- Alert messages -->
				<div th:if="${success}"
					class="alert alert-success alert-dismissible fade show"
					role="alert">
					<span th:text="${success}">Đã cập nhật thành công!</span>
					<button type="button" class="btn-close" data-bs-dismiss="alert"
						aria-label="Close"></button>
				</div>
				<div th:if="${error}"
					class="alert alert-danger alert-dismissible fade show" role="alert">
					<span th:text="${error}">Có lỗi xảy ra!</span>
					<button type="button" class="btn-close" data-bs-dismiss="alert"
						aria-label="Close"></button>
				</div>

				<div class="row">
					<!-- Thông tin đơn hàng -->
					<div class="col-md-6">
						<div class="card">
							<div class="card-header">Thông Tin Đơn Hàng</div>
							<div class="card-body">
								<p>
									<strong>ID:</strong> <span th:text="'#' + ${order.id}">#001</span>
								</p>
								<p>
									<strong>Khách Hàng:</strong> <span
										th:text="${order.nguoiDung.hoTen}">Nguyễn Văn A</span>
								</p>
								<p>
									<strong>Ngày Đặt:</strong> <span
										th:text="${#temporals.format(order.ngayDat, 'dd/MM/yyyy HH:mm')}">25/09/2025
										10:00</span>
								</p>
								<p>
									<strong>Trạng Thái:</strong> <span class="badge bg-warning"
										th:if="${order.trangThai == 'Chờ xác nhận'}">Chờ Xác
										Nhận</span> <span class="badge bg-success"
										th:if="${order.trangThai == 'Đã xác nhận'}">Đã Xác Nhận</span>
									<span class="badge bg-danger"
										th:if="${order.trangThai == 'Đã hủy'}">Đã Hủy</span>
								</p>

								<p>
									<strong>Tổng Tiền:</strong> <span
										th:text="${order.tongTien} + ' ₫'">1.200.000 ₫</span>
								</p>
								<p>
									<strong>Địa Chỉ:</strong> <span th:text="${order.diaChi}">123
										ABC, Q1, TP.HCM</span>
								</p>
								<p>
									<strong>SĐT:</strong> <span th:text="${order.sdt}">0909123456</span>
								</p>
							</div>
						</div>
					</div>

					<!-- Cập nhật trạng thái -->
					<div class="col-md-6">
						<div class="card">
							<div class="card-header">Cập Nhật Trạng Thái</div>
							<div class="card-body">
								<form
									th:action="@{/admin/orders/{id}/update-status(id=${order.id})}"
									method="post">
									<div class="mb-3">
										<label class="form-label">Trạng Thái Mới:</label> <select
											name="newStatus" class="form-select">
											<option value="Chờ xác nhận"
												th:selected="${order.trangThai == 'Chờ xác nhận'}">Chờ
												Xác Nhận</option>
											<option value="Đã xác nhận"
												th:selected="${order.trangThai == 'Đã xác nhận'}">Đã
												Xác Nhận</option>
											<option value="Đã hủy"
												th:selected="${order.trangThai == 'Đã hủy'}">Đã Hủy</option>
										</select>
									</div>
									<button type="submit" class="btn btn-primary">Cập Nhật</button>
								</form>

							</div>
						</div>
					</div>
				</div>


				<div class="row mt-4">
					<div class="col-12">
						<div class="card">
							<div class="card-header">Chi Tiết Sản Phẩm</div>
							<div class="card-body">
								<table class="table">
									<thead>
										<tr>
											<th>Sản Phẩm</th>
											<th>Số Lượng</th>
											<th>Giá</th>
											<th>Thành Tiền</th>
										</tr>
									</thead>
									<tbody>
										<tr th:each="item : ${order.chiTietDonHangs}">
											<td th:text="${item.sach.tenSP}">Sách A</td>
											<td th:text="${item.soLuong}">1</td>
											<td th:text="${item.gia} + ' ₫'">100.000 ₫</td>
											<td th:text="${item.soLuong * item.gia} + ' ₫'">100.000
												₫</td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</main>
		</div>
	</div>

	<!-- Footer -->
	<footer class="bg-dark text-white text-center py-3 mt-4"> ©
		2025 Bookstore Admin </footer>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<script>
		// Auto-hide alerts after 5 seconds
		setTimeout(function() {
			const alerts = document.querySelectorAll('.alert');
			alerts.forEach(function(alert) {
				const bsAlert = new bootstrap.Alert(alert);
				bsAlert.close();
			});
		}, 5000);
	</script>
</body>
</html>